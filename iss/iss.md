# Микроконтроллер как Wi-Fi-осциллограф с передачей данных на ПК (ESP32)

## Введение

Осциллограф — важнейший инструмент в электронике и радиотехнике, предназначенный для визуализации электрических сигналов. В условиях ограниченного бюджета и необходимости мобильности возникает интерес к построению осциллографа на основе микроконтроллера. ESP32, обладающий встроенным Wi-Fi, аналоговыми входами и высокой производительностью, представляет собой подходящую платформу для построения простого осциллографа с передачей данных на ПК по беспроводной сети.

---

## Цель и задачи исследования

**Цель:**  
Разработать и протестировать осциллографическую систему на базе ESP32 с возможностью беспроводной передачи сигналов на персональный компьютер и визуализации в реальном времени.

**Задачи:**
- Проанализировать возможности ESP32 по захвату аналоговых сигналов.
- Настроить систему выборки данных с АЦП.
- Разработать механизм передачи данных по Wi-Fi (UDP/WebSocket).
- Разработать ПО на ПК для визуализации полученных данных.
- Провести тестирование и анализ точности, скорости, стабильности передачи и отображения.

---

## Объект и предмет исследования

- **Объект исследования:** микроконтроллер ESP32 и его возможности работы с аналоговыми сигналами.
- **Предмет исследования:** применение ESP32 в роли Wi-Fi-осциллографа, включая сбор, обработку и передачу аналоговых данных.

---

## Актуальность, научная новизна и практическая значимость

**Актуальность:**  
Многие образовательные учреждения, хобби-проекты и инженеры нуждаются в простых, доступных и портативных средствах визуализации сигналов. Осциллограф на ESP32 — это способ получить минимально необходимый функционал с минимальными затратами.

**Научная новизна:**  
Применение ESP32 в роли осциллографа исследовано слабо. Интерес представляет возможность передачи сигналов в реальном времени по Wi-Fi, ограничения АЦП, частотные характеристики и точность.

**Практическая значимость:**  
Результаты исследования позволяют применять ESP32 в образовательных целях, в полевых условиях, в лабораториях с ограниченным доступом к оборудованию.

---

## Гипотеза

ESP32 способен выполнять функции базового одноканального осциллографа, обеспечивая захват аналоговых сигналов и их передачу по Wi-Fi на ПК с достаточной частотой и точностью для анализа сигналов до 5 кГц.

---

## Анализ источников и существующих решений

### Проект 1 — BojanJurca / `esp32_oscilloscope`
- **Описание:** простой веб-интерфейс на LittleFS, отображает сигнал на HTML-странице.
- **Плюсы:** минимализм, простота, готовый пример для обучения.
- **Минусы:** нестабильная частота, ограниченное количество отсчётов (до 736), нет FFT, ограниченная точность.

### Проект 2 — siliconvalley4066 / `ESP32TFTOscilloscope`
- **Описание:** отображение на TFT-дисплее с сенсорным управлением, поддержка FFT и генератора сигналов.
- **Плюсы:** высокая функциональность, управление через сенсор, поддержка анализа формы сигнала.
- **Минусы:** требует TFT, код сложнее для понимания, ограниченная частота на 2 каналах.

### Проект 3 — Circuit-Digest / `ESP32-Oscilloscope`
- **Описание:** компактный осциллограф с TFT-дисплеем 1.69″, проект ориентирован на сборку с готовой платой.
- **Плюсы:** высокая частота дискретизации до 1 МГц, удобная портативная сборка.
- **Минусы:** нет удалённой передачи данных, всё отображается только на дисплее.

#### Сравнительная таблица

| Проект | Частота дискретизации | Кол-во каналов | Интерфейс | Особенности | Сложность |
|--------|------------------------|----------------|-----------|-------------|-----------|
| BojanJurca | ~700–1000 выборок | 1 | Web (LittleFS) | Простота, браузер | Низкая |
| siliconvalley4066 | до 250 кГц (1 к.) | 2 | TFT + Web | Сенсор, FFT, измерения | Средняя |
| Circuit-Digest | до 1 МГц | 1 | TFT | Компактный, высокая частота | Средняя |

---

## Методология

- **Железо**: ESP32 DevKit v1, аналоговый вход на ADC1\_0 (GPIO36).
- **Программное обеспечение**:
  - Сторона ESP32: Arduino C++, сбор данных через `analogRead`, передача через UDP/WebSocket.
  - ПК: Python-скрипт с использованием `matplotlib` или `pyqtgraph` для отображения сигнала.
- **Тестовые сигналы:** генератор прямоугольных и синусоидальных сигналов (до 5 кГц).
- **Оценка производительности:** задержка, стабильность, точность, прерывистость потока.

---

## Экспериментальные результаты

- **Максимальная частота выборки (реальная):** ~20–25 тыс. выборок/сек (UDP), ограничено `analogRead`.
- **Передача по UDP** обеспечивает минимальную задержку, но возможна потеря пакетов.
- **Передача по WebSocket** — стабильнее, но с большей задержкой.
- **Точность АЦП:** ±3–5 ед. (из 4096), зависит от шумов и скорости.
- **Интерфейс ПК:** позволяет отображать сигнал в реальном времени с задержкой до 150–200 мс.

---

## Интерпретация результатов

- ESP32 пригоден для измерения сигналов частотой до 2–5 кГц.
- На частотах выше появляются искажения из-за:
  - Нестабильной дискретизации (`analogRead` не гарантирует точный интервал).
  - Потерь при передаче (особенно при больших буферах).
- Передача по Wi-Fi требует балансировки между скоростью и надёжностью.

---

## Выводы

- **Цель и задачи** достигнуты: реализован базовый Wi-Fi-осциллограф с выводом на ПК.
- **Гипотеза подтверждена частично**:
  - Возможна передача и визуализация сигналов до 5 кГц.
  - Требует учёта нестабильности и погрешности.
- **ESP32 — пригоден как простой учебный осциллограф**.
- **Сложные сигналы и точные измерения требуют аппаратных доработок**.

---

## Перспективы

- Использование DMA и I2S для высокоскоростного захвата.
- Реализация буферов и автоматической калибровки.
- Поддержка нескольких каналов через мультиплексор.
- Передача по BLE или Ethernet.
- Добавление функций: FFT, триггеров, спектрального анализа.

---

## Благодарности

Проекты:
- https://github.com/BojanJurca/esp32_oscilloscope
- https://github.com/siliconvalley4066/ESP32TFTOscilloscope
- https://circuitdigest.com/microcontroller-projects/esp32-based-oscilloscope
